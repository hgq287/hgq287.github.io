<!DOCTYPE html><!--0nxdehzg2fPKXstUAUz86--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" href="/favicon.ico"/><link rel="stylesheet" href="/_next/static/chunks/cad2ac7522982531.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/chunks/d9210178e8c0587f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/2e4df37f022f10db.js"/><script src="/_next/static/chunks/1136a3c698ffd364.js" async=""></script><script src="/_next/static/chunks/4202645cbb480fff.js" async=""></script><script src="/_next/static/chunks/2103e26662f0391b.js" async=""></script><script src="/_next/static/chunks/turbopack-1327df8fd5e7ec21.js" async=""></script><script src="/_next/static/chunks/10f45d08b09cdbe8.js" async=""></script><script src="/_next/static/chunks/129931008aaa511c.js" async=""></script><script src="/_next/static/chunks/4150d164f44f149b.js" async=""></script><script src="/_next/static/chunks/cdae93da8dc904d5.js" async=""></script><title>Post not found | Hg&#x27;s Portfolio</title><meta name="description" content="A Full-Stack Software Engineer and Solutions Architect"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("data-theme","theme","system",null,["light","dark"],null,true,true)</script><header class="Blog-module__D9J00W__header"><div class="Blog-module__D9J00W__container"><div class="Blog-module__D9J00W__leftSection"><button class="Blog-module__D9J00W__menuButton"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button><div><a href="/"><img src="/favicon.ico" alt="Logo" width="32" height="32"/></a></div><div class="Blog-module__D9J00W__textInfo "><h1 class="Blog-module__D9J00W__blogTitle">Building a Modern Authentication System: OAuth 2.0 &amp; JWT (RS256)</h1><p class="Blog-module__D9J00W__headline">A simple guide to our Hybrid Security Architecture, using stateless JWT Access Tokens and revocable Refresh Tokens for better security and speed.</p></div></div></div></header><div class="Blog-module__D9J00W__drawer "><div class="Blog-module__D9J00W__drawerOverlay"></div><nav class="Blog-module__D9J00W__drawerContent"><div class="Blog-module__D9J00W__drawerHeader"><a href="/"><img src="/favicon.ico" alt="Logo" width="32" height="32"/></a><button>âœ•</button></div></nav></div><div class="Blog-module__D9J00W__blogLayout"><aside class="Blog-module__D9J00W__sidebarWrapper"><div style="font-family:inherit"><h3 style="font-size:1.2rem;margin:1.5em 0 0.5em;font-weight:400">All Posts</h3><nav><ul style="list-style-type:none;padding:0;margin:0;display:flex;flex-direction:column;gap:4px"><li><a style="display:block;padding:8px 12px;border-radius:4px;transition:all 0.15s ease-in-out;font-size:14px;line-height:1.4;background-color:transparent;color:#000000de;font-weight:400" href="/blog/design-patterns-resource"><div style="line-height:1.4;font-weight:inherit">Essential Resource: Software Design Patterns</div></a></li><li><a style="display:block;padding:8px 12px;border-radius:4px;transition:all 0.15s ease-in-out;font-size:14px;line-height:1.4;background-color:transparent;color:#4051b5;font-weight:550" href="/blog/mastering-oauth2-jwt"><div style="line-height:1.4;font-weight:inherit">Building a Modern Authentication System: OAuth 2.0 &amp; JWT (RS256)</div></a></li><li><a style="display:block;padding:8px 12px;border-radius:4px;transition:all 0.15s ease-in-out;font-size:14px;line-height:1.4;background-color:transparent;color:#000000de;font-weight:400" href="/blog/nextjs-blog-architecture-summary"><div style="line-height:1.4;font-weight:inherit">Next.js Blog Architecture Summary: Core Stack &amp; Optimization</div></a></li></ul></nav></div></aside><main class="Blog-module__D9J00W__article"><article><h1>Building a Modern Authentication System: OAuth 2.0 &amp; JWT (RS256)</h1><div class="PostMeta-module__q8C1Pq__metaContainer"><time class="PostMeta-module__q8C1Pq__date">ðŸ“… <!-- -->December 11, 2025</time><div class="PostMeta-module__q8C1Pq__divider">|</div><div class="PostMeta-module__q8C1Pq__tagsList"><a href="/blog?tag=OAuth2" class="PostMeta-module__q8C1Pq__tagBadge">#<!-- -->OAuth2</a><a href="/blog?tag=Security" class="PostMeta-module__q8C1Pq__tagBadge">#<!-- -->Security</a><a href="/blog?tag=JWT" class="PostMeta-module__q8C1Pq__tagBadge">#<!-- -->JWT</a><a href="/blog?tag=Backend" class="PostMeta-module__q8C1Pq__tagBadge">#<!-- -->Backend</a><a href="/blog?tag=Architecture" class="PostMeta-module__q8C1Pq__tagBadge">#<!-- -->Architecture</a></div></div><div class="prose max-w-none"><p>Welcome to my first technical deep dive!</p>
<p>In this post, we explore how we built a super-secure and fast login system. We are using a <strong>Hybrid Security Architecture</strong> that combines <strong>OAuth 2.0</strong> rules with <strong>JSON Web Tokens (JWTs)</strong> signed by <strong>RS256</strong>.</p>
<h2 id="1-architecture-overview-speed-meets-security" class="pt-20 -mt-20">1. Architecture Overview: Speed Meets Security</h2>
<p>Our goal is simple: make the system fast by making the access key self-checking.</p>
<table><thead><tr><th style="text-align:left">Component</th><th style="text-align:left">Technology</th><th style="text-align:left">Main Job</th><th style="text-align:left">Key Feature</th></tr></thead><tbody><tr><td style="text-align:left"><strong>Access Token</strong></td><td style="text-align:left"><code>JWT (RS256)</code></td><td style="text-align:left">The key to accessing our APIs.</td><td style="text-align:left"><strong>Stateless</strong> (No DB check needed for verification).</td></tr><tr><td style="text-align:left"><strong>Refresh Token</strong></td><td style="text-align:left"><code>Opaque String</code></td><td style="text-align:left">The key to get a new Access Token.</td><td style="text-align:left"><strong>Revocable</strong> (Can be canceled instantly in the DB).</td></tr><tr><td style="text-align:left"><strong>Server Core</strong></td><td style="text-align:left"><code>express-oauth-server</code></td><td style="text-align:left">Manages all the login and permission rules.</td><td style="text-align:left">Follows industry standards.</td></tr><tr><td style="text-align:left"><strong>Database</strong></td><td style="text-align:left"><code>PostgreSQL/Prisma</code></td><td style="text-align:left">Stores users and the long-term Refresh Tokens.</td><td style="text-align:left">Data integrity.</td></tr></tbody></table>
<h2 id="2-token-strategy-why-two-keys" class="pt-20 -mt-20">2. Token Strategy: Why Two Keys?</h2>
<p>We use two types of tokens because each has a different security role.</p>
<h3 id="a-access-token-the-fast-key" class="pt-20 -mt-20">A. Access Token (The Fast Key)</h3>
<ol>
<li><strong>Format:</strong> JSON Web Token (JWT).</li>
<li><strong>Validation:</strong> Signed using a <strong>Private Key</strong> (RS256). The server checks its validity using a <strong>Public Key</strong>.</li>
<li><strong>Benefit:</strong> This is extremely fast because the server doesn&#x27;t need to check the database every time an API is called.</li>
<li><strong>Lifespan:</strong> Short (e.g., 1 hour).</li>
</ol>
<h3 id="b-refresh-token-the-safe-key" class="pt-20 -mt-20">B. Refresh Token (The Safe Key)</h3>
<ol>
<li><strong>Format:</strong> A random, meaningless string (Opaque Token).</li>
<li><strong>Safety:</strong> It <strong>must be saved in the database</strong>. This is the only way we can track long-term sessions.</li>
<li><strong>Benefit:</strong> If a user&#x27;s account is compromised, we can delete the Refresh Token from the database, instantly blocking their ability to get new Access Tokens.</li>
<li><strong>Lifespan:</strong> Long (e.g., 1 week).</li>
</ol>
<h2 id="3-supported-login-flows" class="pt-20 -mt-20">3. Supported Login Flows</h2>
<h3 id="31-password-grant-the-main-sign-in-flow" class="pt-20 -mt-20">3.1. Password Grant (The Main Sign-in Flow)</h3>
<ul>
<li><strong>Endpoint:</strong> <code>POST /v1/signin</code></li>
<li><strong>How it Works:</strong> This is a custom solution we built to fix a library bug.<!-- -->
<ul>
<li>Client ID/Secret sent in the <strong>Basic Auth Header</strong>.</li>
<li>Username/Password sent in the <strong>JSON Body</strong>.</li>
<li>The server manually processes the request to ensure tokens are issued correctly.</li>
</ul>
</li>
</ul>
<h3 id="32-authorization-code-grant" class="pt-20 -mt-20">3.2. Authorization Code Grant</h3>
<ul>
<li><strong>Endpoint:</strong> <code>GET /v1/oauth/authorize</code></li>
<li><strong>Use Case:</strong> The standard, safest way for third-party apps (like a web service) to get limited access to your user&#x27;s data.</li>
</ul>
<h2 id="4-key-code-logic-object-object" class="pt-20 -mt-20">4. Key Code Logic (<code>oauth.model.ts</code>)</h2>
<p>Our custom security logic lives in the model file. Hereâ€™s what the key functions do:</p>
<table><thead><tr><th style="text-align:left">Model Function</th><th style="text-align:left">What it Does</th></tr></thead><tbody><tr><td style="text-align:left"><strong><code>generateAccessToken</code></strong></td><td style="text-align:left"><strong>Creates the JWT</strong> and signs it using our Private Key.</td></tr><tr><td style="text-align:left"><strong><code>getAccessToken</code></strong></td><td style="text-align:left"><strong>Verifies the JWT signature</strong> using the Public Key. (It doesn&#x27;t touch the database).</td></tr><tr><td style="text-align:left"><strong><code>saveToken</code></strong></td><td style="text-align:left"><strong>Only saves the Refresh Token</strong> to the DB. (It ignores the Access Token).</td></tr><tr><td style="text-align:left"><strong><code>revokeToken</code></strong></td><td style="text-align:left">Deletes the Refresh Token from the database.</td></tr><tr><td style="text-align:left"><strong><code>getUser</code></strong></td><td style="text-align:left">Checks the user&#x27;s email and password during login.</td></tr></tbody></table>
<h2 id="5-conclusion" class="pt-20 -mt-20">5. Conclusion</h2>
<p>By moving to this <strong>JWT/RS256</strong> architecture, we solved complex library bugs and achieved a fast, reliable, and modern security system. This foundation is ready to scale with our application!</p></div></article></main><aside class="Blog-module__D9J00W__minimapWrapper"><nav style="padding:8px 0;font-size:14px"><h3 style="font-size:1.2rem;margin:1.5em 0 0.5em;font-weight:400">Table of Contents</h3><ul style="list-style-type:none;padding:0;margin:0"><li style="margin-bottom:8px;margin-left:0px"><a href="#1-architecture-overview-speed-meets-security" style="color:#4a5568;text-decoration:none;transition:color 0.15s ease-in-out;display:block;line-height:1.4;font-weight:500">1. Architecture Overview: Speed Meets Security</a></li><li style="margin-bottom:8px;margin-left:0px"><a href="#2-token-strategy-why-two-keys" style="color:#4a5568;text-decoration:none;transition:color 0.15s ease-in-out;display:block;line-height:1.4;font-weight:500">2. Token Strategy: Why Two Keys?</a></li><li style="margin-bottom:8px;margin-left:16px"><a href="#a-access-token-the-fast-key" style="color:#6b7280;text-decoration:none;transition:color 0.15s ease-in-out;display:block;line-height:1.4;font-weight:400">A. Access Token (The Fast Key)</a></li><li style="margin-bottom:8px;margin-left:16px"><a href="#b-refresh-token-the-safe-key" style="color:#6b7280;text-decoration:none;transition:color 0.15s ease-in-out;display:block;line-height:1.4;font-weight:400">B. Refresh Token (The Safe Key)</a></li><li style="margin-bottom:8px;margin-left:0px"><a href="#3-supported-login-flows" style="color:#4a5568;text-decoration:none;transition:color 0.15s ease-in-out;display:block;line-height:1.4;font-weight:500">3. Supported Login Flows</a></li><li style="margin-bottom:8px;margin-left:16px"><a href="#31-password-grant-the-main-sign-in-flow" style="color:#6b7280;text-decoration:none;transition:color 0.15s ease-in-out;display:block;line-height:1.4;font-weight:400">3.1. Password Grant (The Main Sign-in Flow)</a></li><li style="margin-bottom:8px;margin-left:16px"><a href="#32-authorization-code-grant" style="color:#6b7280;text-decoration:none;transition:color 0.15s ease-in-out;display:block;line-height:1.4;font-weight:400">3.2. Authorization Code Grant</a></li><li style="margin-bottom:8px;margin-left:0px"><a href="#4-key-code-logic-oauthmodelts" style="color:#4a5568;text-decoration:none;transition:color 0.15s ease-in-out;display:block;line-height:1.4;font-weight:500">4. Key Code Logic (`oauth.model.ts`)</a></li><li style="margin-bottom:8px;margin-left:0px"><a href="#5-conclusion" style="color:#4a5568;text-decoration:none;transition:color 0.15s ease-in-out;display:block;line-height:1.4;font-weight:500">5. Conclusion</a></li></ul></nav></aside></div><!--$--><!--/$--><script src="/_next/static/chunks/2e4df37f022f10db.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[35972,[\"/_next/static/chunks/10f45d08b09cdbe8.js\"],\"ThemeProvider\"]\n3:I[39447,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"default\"]\n4:I[893,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"default\"]\n6:I[20191,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[20191,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"ViewportBoundary\"]\nb:I[20191,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"MetadataBoundary\"]\nd:I[88496,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"default\"]\n:HL[\"/_next/static/chunks/cad2ac7522982531.css\",\"style\"]\n:HL[\"/_next/static/chunks/d9210178e8c0587f.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"0nxdehzg2fPKXstUAUz86\",\"c\":[\"\",\"blog\",\"mastering-oauth2-jwt\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"mastering-oauth2-jwt\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/cad2ac7522982531.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/10f45d08b09cdbe8.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"data-theme\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/d9210178e8c0587f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/cdae93da8dc904d5.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[44338,[\"/_next/static/chunks/10f45d08b09cdbe8.js\",\"/_next/static/chunks/cdae93da8dc904d5.js\"],\"default\"]\nf:I[16737,[\"/_next/static/chunks/10f45d08b09cdbe8.js\",\"/_next/static/chunks/cdae93da8dc904d5.js\"],\"default\"]\n10:I[12036,[\"/_next/static/chunks/10f45d08b09cdbe8.js\",\"/_next/static/chunks/cdae93da8dc904d5.js\"],\"default\"]\n"])</script><script>self.__next_f.push([1,"5:[[\"$\",\"$Le\",null,{\"title\":\"Building a Modern Authentication System: OAuth 2.0 \u0026 JWT (RS256)\",\"headline\":\"A simple guide to our Hybrid Security Architecture, using stateless JWT Access Tokens and revocable Refresh Tokens for better security and speed.\"}],[\"$\",\"div\",null,{\"className\":\"Blog-module__D9J00W__blogLayout\",\"children\":[[\"$\",\"aside\",null,{\"className\":\"Blog-module__D9J00W__sidebarWrapper\",\"children\":[\"$\",\"$Lf\",null,{\"allPostsMetadata\":[{\"slug\":\"design-patterns-resource\",\"title\":\"Essential Resource: Software Design Patterns\",\"date\":\"2025-12-12T00:00:00.000Z\",\"excerpt\":\"This post shares a highly recommended resource for learning about Software Design Patterns\",\"tags\":[\"design-patterns\",\"Docs\"]},{\"slug\":\"mastering-oauth2-jwt\",\"title\":\"Building a Modern Authentication System: OAuth 2.0 \u0026 JWT (RS256)\",\"date\":\"2025-12-11T00:00:00.000Z\",\"excerpt\":\"A simple guide to our Hybrid Security Architecture, using stateless JWT Access Tokens and revocable Refresh Tokens for better security and speed.\",\"tags\":[\"OAuth2\",\"Security\",\"JWT\",\"Backend\",\"Architecture\"]},{\"slug\":\"nextjs-blog-architecture-summary\",\"title\":\"Next.js Blog Architecture Summary: Core Stack \u0026 Optimization\",\"date\":\"2025-12-09T00:00:00.000Z\",\"excerpt\":\"This technical overview outlines the core stack and architectural design principles applied to this high-performance Next.js blog application.\",\"tags\":[\"Next.js\",\"Architecture\",\"TypeScript\",\"SSG\",\"Performance\"]}],\"activeSlug\":\"mastering-oauth2-jwt\"}]}],[\"$\",\"main\",null,{\"className\":\"Blog-module__D9J00W__article\",\"children\":[\"$\",\"article\",null,{\"children\":[[\"$\",\"h1\",null,{\"children\":\"Building a Modern Authentication System: OAuth 2.0 \u0026 JWT (RS256)\"}],[\"$\",\"$L10\",null,{\"date\":\"2025-12-11T00:00:00.000Z\",\"tags\":\"$5:1:props:children:0:props:children:props:allPostsMetadata:1:tags\"}],[\"$\",\"div\",null,{\"className\":\"prose max-w-none\",\"children\":[[\"$\",\"p\",\"p-0\",{\"children\":\"Welcome to my first technical deep dive!\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"In this post, we explore how we built a super-secure and fast login system. We are using a \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"Hybrid Security Architecture\"}],\" that combines \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"OAuth 2.0\"}],\" rules with \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"JSON Web Tokens (JWTs)\"}],\" signed by \",[\"$\",\"strong\",\"strong-3\",{\"children\":\"RS256\"}],\".\"]}],\"\\n\",[\"$\",\"h2\",\"h2-0\",{\"id\":\"1-architecture-overview-speed-meets-security\",\"className\":\"pt-20 -mt-20\",\"children\":\"1. Architecture Overview: Speed Meets Security\"}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"Our goal is simple: make the system fast by making the access key self-checking.\"}],\"\\n\",[\"$\",\"table\",\"table-0\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Component\"}],[\"$\",\"th\",\"th-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Technology\"}],[\"$\",\"th\",\"th-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Main Job\"}],[\"$\",\"th\",\"th-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Key Feature\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"Access Token\"}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"code\",\"code-0\",{\"children\":\"JWT (RS256)\"}]}],[\"$\",\"td\",\"td-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"The key to accessing our APIs.\"}],[\"$\",\"td\",\"td-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Stateless\"}],\" (No DB check needed for verification).\"]}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"Refresh Token\"}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"code\",\"code-0\",{\"children\":\"Opaque String\"}]}],[\"$\",\"td\",\"td-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"The key to get a new Access Token.\"}],[\"$\",\"td\",\"td-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Revocable\"}],\" (Can be canceled instantly in the DB).\"]}]]}],[\"$\",\"tr\",\"tr-2\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"Server Core\"}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"$L11\"}],\"$L12\",\"$L13\"]}],\"$L14\"]}]]}],\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\",\"\\n\",\"$L1e\",\"\\n\",\"$L1f\",\"\\n\",\"$L20\",\"\\n\",\"$L21\",\"\\n\",\"$L22\",\"\\n\",\"$L23\",\"\\n\",\"$L24\"]}]]}]}],\"$L25\"]}]]\n"])</script><script>self.__next_f.push([1,"26:I[35916,[\"/_next/static/chunks/10f45d08b09cdbe8.js\",\"/_next/static/chunks/cdae93da8dc904d5.js\"],\"default\"]\n11:[\"$\",\"code\",\"code-0\",{\"children\":\"express-oauth-server\"}]\n12:[\"$\",\"td\",\"td-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Manages all the login and permission rules.\"}]\n13:[\"$\",\"td\",\"td-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Follows industry standards.\"}]\n14:[\"$\",\"tr\",\"tr-3\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"Database\"}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"code\",\"code-0\",{\"children\":\"PostgreSQL/Prisma\"}]}],[\"$\",\"td\",\"td-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Stores users and the long-term Refresh Tokens.\"}],[\"$\",\"td\",\"td-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Data integrity.\"}]]}]\n15:[\"$\",\"h2\",\"h2-1\",{\"id\":\"2-token-strategy-why-two-keys\",\"className\":\"pt-20 -mt-20\",\"children\":\"2. Token Strategy: Why Two Keys?\"}]\n16:[\"$\",\"p\",\"p-3\",{\"children\":\"We use two types of tokens because each has a different security role.\"}]\n17:[\"$\",\"h3\",\"h3-0\",{\"id\":\"a-access-token-the-fast-key\",\"className\":\"pt-20 -mt-20\",\"children\":\"A. Access Token (The Fast Key)\"}]\n18:[\"$\",\"ol\",\"ol-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Format:\"}],\" JSON Web Token (JWT).\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Validation:\"}],\" Signed using a \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"Private Key\"}],\" (RS256). The server checks its validity using a \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"Public Key\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Benefit:\"}],\" This is extremely fast because the server doesn't need to check the database every time an API is called.\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Lifespan:\"}],\" Short (e.g., 1 hour).\"]}],\"\\n\"]}]\n19:[\"$\",\"h3\",\"h3-1\",{\"id\":\"b-refresh-token-the-safe-key\",\"className\":\"pt-20 -mt-20\",\"children\":\"B. Refresh Token (The Safe Key)\"}]\n1a:[\"$\",\"ol\",\"ol-1\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Format:\"}],\" A random, meaningless string (Opaque Token).\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Safety:\"}],\" It \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"must be saved in the database\"}],\". This is the only way we can track long-term sessions.\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Benefit:\"}],\" If a user's account is compromised, we can delete the Refresh Token from the database, instantly blocking their ability to get new Access Tokens.\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Lifespan:\"}],\" Long (e.g., 1 week).\"]}],\"\\n\"]}]\n1b:[\"$\",\"h2\",\"h2-2\",{\"id\":\"3-supported-login-flows\",\"className\":\"pt-20 -mt-20\",\"children\":\"3. Supported Login Flows\"}]\n1c:[\"$\",\"h3\",\"h3-2\",{\"id\":\"31-password-grant-the-main-sign-in-flow\",\"className\":\"pt-20 -mt-20\",\"children\":\"3.1. Password Grant (The Main Sign-in Flow)\"}]\n1d:[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Endpoint:\"}],\" \",[\"$\",\"code\",\"code-0\",{\"children\":\"POST /v1/signin\"}]]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"How it Works:\"}],\" This is a custom solution we built to fix a library bug.\",\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"Client ID/Secret sent in the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"Basic Auth Header\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"Username/Password sent in the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"JSON Body\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":\"The server manually processes the request to ensure tokens are issued correctly.\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}]\n1e:[\"$\",\"h3\",\"h3-3\",{\"id\":\"32-authorization-code-grant\",\"className\":\"pt-20 -mt-20\",\"children\":\"3.2. Authorization Code Grant\"}]\n1f:[\"$\",\"ul\",\"ul-1\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Endpoint:\"}],\" \",[\"$"])</script><script>self.__next_f.push([1,"\",\"code\",\"code-0\",{\"children\":\"GET /v1/oauth/authorize\"}]]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Use Case:\"}],\" The standard, safest way for third-party apps (like a web service) to get limited access to your user's data.\"]}],\"\\n\"]}]\n20:[\"$\",\"h2\",\"h2-3\",{\"id\":\"4-key-code-logic-object-object\",\"className\":\"pt-20 -mt-20\",\"children\":[\"4. Key Code Logic (\",[\"$\",\"code\",\"code-0\",{\"children\":\"oauth.model.ts\"}],\")\"]}]\n21:[\"$\",\"p\",\"p-4\",{\"children\":\"Our custom security logic lives in the model file. Hereâ€™s what the key functions do:\"}]\n"])</script><script>self.__next_f.push([1,"22:[\"$\",\"table\",\"table-1\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Model Function\"}],[\"$\",\"th\",\"th-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"What it Does\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"code\",\"code-0\",{\"children\":\"generateAccessToken\"}]}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Creates the JWT\"}],\" and signs it using our Private Key.\"]}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"code\",\"code-0\",{\"children\":\"getAccessToken\"}]}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Verifies the JWT signature\"}],\" using the Public Key. (It doesn't touch the database).\"]}]]}],[\"$\",\"tr\",\"tr-2\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"code\",\"code-0\",{\"children\":\"saveToken\"}]}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Only saves the Refresh Token\"}],\" to the DB. (It ignores the Access Token).\"]}]]}],[\"$\",\"tr\",\"tr-3\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"code\",\"code-0\",{\"children\":\"revokeToken\"}]}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Deletes the Refresh Token from the database.\"}]]}],[\"$\",\"tr\",\"tr-4\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"code\",\"code-0\",{\"children\":\"getUser\"}]}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Checks the user's email and password during login.\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"23:[\"$\",\"h2\",\"h2-4\",{\"id\":\"5-conclusion\",\"className\":\"pt-20 -mt-20\",\"children\":\"5. Conclusion\"}]\n24:[\"$\",\"p\",\"p-5\",{\"children\":[\"By moving to this \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"JWT/RS256\"}],\" architecture, we solved complex library bugs and achieved a fast, reliable, and modern security system. This foundation is ready to scale with our application!\"]}]\n27:Tcac,"])</script><script>self.__next_f.push([1,"\nWelcome to my first technical deep dive! \n\nIn this post, we explore how we built a super-secure and fast login system. We are using a **Hybrid Security Architecture** that combines **OAuth 2.0** rules with **JSON Web Tokens (JWTs)** signed by **RS256**.\n\n## 1. Architecture Overview: Speed Meets Security\n\nOur goal is simple: make the system fast by making the access key self-checking.\n\n| Component | Technology | Main Job | Key Feature |\n| :--- | :--- | :--- | :--- |\n| **Access Token** | `JWT (RS256)` | The key to accessing our APIs. | **Stateless** (No DB check needed for verification). |\n| **Refresh Token** | `Opaque String` | The key to get a new Access Token. | **Revocable** (Can be canceled instantly in the DB). |\n| **Server Core** | `express-oauth-server` | Manages all the login and permission rules. | Follows industry standards. |\n| **Database** | `PostgreSQL/Prisma` | Stores users and the long-term Refresh Tokens. | Data integrity. |\n\n## 2. Token Strategy: Why Two Keys?\n\nWe use two types of tokens because each has a different security role.\n\n### A. Access Token (The Fast Key)\n\n1.  **Format:** JSON Web Token (JWT).\n2.  **Validation:** Signed using a **Private Key** (RS256). The server checks its validity using a **Public Key**.\n3.  **Benefit:** This is extremely fast because the server doesn't need to check the database every time an API is called.\n4.  **Lifespan:** Short (e.g., 1 hour).\n\n### B. Refresh Token (The Safe Key)\n\n1.  **Format:** A random, meaningless string (Opaque Token).\n2.  **Safety:** It **must be saved in the database**. This is the only way we can track long-term sessions.\n3.  **Benefit:** If a user's account is compromised, we can delete the Refresh Token from the database, instantly blocking their ability to get new Access Tokens.\n4.  **Lifespan:** Long (e.g., 1 week).\n\n## 3. Supported Login Flows\n\n### 3.1. Password Grant (The Main Sign-in Flow)\n\n* **Endpoint:** `POST /v1/signin`\n* **How it Works:** This is a custom solution we built to fix a library bug.\n    * Client ID/Secret sent in the **Basic Auth Header**.\n    * Username/Password sent in the **JSON Body**.\n    * The server manually processes the request to ensure tokens are issued correctly.\n\n### 3.2. Authorization Code Grant\n\n* **Endpoint:** `GET /v1/oauth/authorize`\n* **Use Case:** The standard, safest way for third-party apps (like a web service) to get limited access to your user's data.\n\n## 4. Key Code Logic (`oauth.model.ts`)\n\nOur custom security logic lives in the model file. Hereâ€™s what the key functions do:\n\n| Model Function | What it Does |\n| :--- | :--- |\n| **`generateAccessToken`** | **Creates the JWT** and signs it using our Private Key. |\n| **`getAccessToken`** | **Verifies the JWT signature** using the Public Key. (It doesn't touch the database). |\n| **`saveToken`** | **Only saves the Refresh Token** to the DB. (It ignores the Access Token). |\n| **`revokeToken`** | Deletes the Refresh Token from the database. |\n| **`getUser`** | Checks the user's email and password during login. |\n\n## 5. Conclusion\n\nBy moving to this **JWT/RS256** architecture, we solved complex library bugs and achieved a fast, reliable, and modern security system. This foundation is ready to scale with our application!"])</script><script>self.__next_f.push([1,"25:[\"$\",\"aside\",null,{\"className\":\"Blog-module__D9J00W__minimapWrapper\",\"children\":[\"$\",\"$L26\",null,{\"content\":\"$27\"}]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"title\",\"0\",{\"children\":\"Post not found | Hg's Portfolio\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"A Full-Stack Software Engineer and Solutions Architect\"}]]\n8:null\n"])</script></body></html>