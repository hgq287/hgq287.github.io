<!DOCTYPE html><!--peCCg1EsvjH8LOG9VA3pF--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/chunks/516aabbd5e7f833d.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/2e4df37f022f10db.js"/><script src="/_next/static/chunks/1136a3c698ffd364.js" async=""></script><script src="/_next/static/chunks/4202645cbb480fff.js" async=""></script><script src="/_next/static/chunks/2103e26662f0391b.js" async=""></script><script src="/_next/static/chunks/turbopack-1327df8fd5e7ec21.js" async=""></script><script src="/_next/static/chunks/10f45d08b09cdbe8.js" async=""></script><script src="/_next/static/chunks/129931008aaa511c.js" async=""></script><script src="/_next/static/chunks/4150d164f44f149b.js" async=""></script><script src="/_next/static/chunks/b6d55b6773924599.js" async=""></script><title>Hg Q. - Portfolio &amp; Profiles</title><meta name="description" content="A Full-Stack Software Engineer and Solutions Architect"/><script src="/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body><div hidden=""><!--$--><!--/$--></div><script>((a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}})("data-theme","theme","light",null,["light","dark"],null,true,true)</script><div class="flex"><aside class="w-64 border-r p-4 h-screen overflow-y-auto sticky top-0"><h2 class="font-bold mb-4 text-lg">All Posts</h2><ul class="space-y-2"><li><a class="hover:text-blue-600 text-sm" href="/blog/mastering-oauth2-jwt">Building a Modern Authentication System: OAuth 2.0 &amp; JWT (RS256)</a></li></ul></aside><main class="flex-1 p-8 prose max-w-3xl"><h1>Building a Modern Authentication System: OAuth 2.0 &amp; JWT (RS256)</h1><p>Welcome to my first technical deep dive!</p>
<p>In this post, we explore how we built a super-secure and fast login system. We are using a <strong>Hybrid Security Architecture</strong> that combines <strong>OAuth 2.0</strong> rules with <strong>JSON Web Tokens (JWTs)</strong> signed by <strong>RS256</strong>.</p>
<h2 id="1-architecture-overview-speed-meets-security"><a href="#1-architecture-overview-speed-meets-security">1. Architecture Overview: Speed Meets Security</a></h2>
<p>Our goal is simple: make the system fast by making the access key self-checking.</p>
<table><thead><tr><th style="text-align:left">Component</th><th style="text-align:left">Technology</th><th style="text-align:left">Main Job</th><th style="text-align:left">Key Feature</th></tr></thead><tbody><tr><td style="text-align:left"><strong>Access Token</strong></td><td style="text-align:left"><strong>JWT (RS256)</strong></td><td style="text-align:left">The key to accessing our APIs.</td><td style="text-align:left"><strong>Stateless</strong> (No DB check needed for verification).</td></tr><tr><td style="text-align:left"><strong>Refresh Token</strong></td><td style="text-align:left">Opaque String</td><td style="text-align:left">The key to get a new Access Token.</td><td style="text-align:left"><strong>Revocable</strong> (Can be canceled instantly in the DB).</td></tr><tr><td style="text-align:left"><strong>Server Core</strong></td><td style="text-align:left"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-text" style="white-space:pre;color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>express-oauth-server</span></code></pre></td><td style="text-align:left">Manages all the login and permission rules.</td><td style="text-align:left">Follows industry standards.</td></tr><tr><td style="text-align:left"><strong>Database</strong></td><td style="text-align:left">PostgreSQL/Prisma</td><td style="text-align:left">Stores users and the long-term Refresh Tokens.</td><td style="text-align:left">Data integrity.</td></tr></tbody></table>
<h2 id="2-token-strategy-why-two-keys"><a href="#2-token-strategy-why-two-keys">2. Token Strategy: Why Two Keys?</a></h2>
<p>We use two types of tokens because each has a different security role.</p>
<h3 id="a-access-token-the-fast-key"><a href="#a-access-token-the-fast-key">A. Access Token (The Fast Key)</a></h3>
<ol>
<li><strong>Format:</strong> JSON Web Token (JWT).</li>
<li><strong>Validation:</strong> Signed using a <strong>Private Key</strong> (RS256). The server checks its validity using a <strong>Public Key</strong>.</li>
<li><strong>Benefit:</strong> This is extremely fast because the server doesn&#x27;t need to check the database every time an API is called.</li>
<li><strong>Lifespan:</strong> Short (e.g., 1 hour).</li>
</ol>
<h3 id="b-refresh-token-the-safe-key"><a href="#b-refresh-token-the-safe-key">B. Refresh Token (The Safe Key)</a></h3>
<ol>
<li><strong>Format:</strong> A random, meaningless string (Opaque Token).</li>
<li><strong>Safety:</strong> It <strong>must be saved in the database</strong>. This is the only way we can track long-term sessions.</li>
<li><strong>Benefit:</strong> If a user&#x27;s account is compromised, we can delete the Refresh Token from the database, instantly blocking their ability to get new Access Tokens.</li>
<li><strong>Lifespan:</strong> Long (e.g., 1 week).</li>
</ol>
<h2 id="3-supported-login-flows"><a href="#3-supported-login-flows">3. Supported Login Flows</a></h2>
<h3 id="31-password-grant-the-main-sign-in-flow"><a href="#31-password-grant-the-main-sign-in-flow">3.1. Password Grant (The Main Sign-in Flow)</a></h3>
<ul>
<li><strong>Endpoint:</strong> <pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-text" style="white-space:pre;color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>POST /v1/signin</span></code></pre></li>
<li><strong>How it Works:</strong> This is a custom solution we built to fix a library bug.<!-- -->
<ul>
<li>Client ID/Secret sent in the <strong>Basic Auth Header</strong>.</li>
<li>Username/Password sent in the <strong>JSON Body</strong>.</li>
<li>The server manually processes the request to ensure tokens are issued correctly.</li>
</ul>
</li>
</ul>
<h3 id="32-authorization-code-grant"><a href="#32-authorization-code-grant">3.2. Authorization Code Grant</a></h3>
<ul>
<li><strong>Endpoint:</strong> <pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-text" style="white-space:pre;color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>GET /v1/oauth/authorize</span></code></pre></li>
<li><strong>Use Case:</strong> The standard, safest way for third-party apps (like a web service) to get limited access to your user&#x27;s data.</li>
</ul>
<h2 id="4-key-code-logic-oauthmodelts"><a href="#4-key-code-logic-oauthmodelts">4. Key Code Logic (<pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-text" style="white-space:pre;color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>oauth.model.ts</span></code></pre>)</a></h2>
<p>Our custom security logic lives in the model file. Here’s what the key functions do:</p>
<table><thead><tr><th style="text-align:left">Model Function</th><th style="text-align:left">What it Does</th></tr></thead><tbody><tr><td style="text-align:left"><strong><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-text" style="white-space:pre;color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>generateAccessToken</span></code></pre></strong></td><td style="text-align:left"><strong>Creates the JWT</strong> and signs it using our Private Key.</td></tr><tr><td style="text-align:left"><strong><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-text" style="white-space:pre;color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>getAccessToken</span></code></pre></strong></td><td style="text-align:left"><strong>Verifies the JWT signature</strong> using the Public Key. (It doesn&#x27;t touch the database).</td></tr><tr><td style="text-align:left"><strong><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-text" style="white-space:pre;color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>saveToken</span></code></pre></strong></td><td style="text-align:left"><strong>Only saves the Refresh Token</strong> to the DB. (It ignores the Access Token).</td></tr><tr><td style="text-align:left"><strong><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-text" style="white-space:pre;color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>revokeToken</span></code></pre></strong></td><td style="text-align:left">Deletes the Refresh Token from the database.</td></tr><tr><td style="text-align:left"><strong><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-text" style="white-space:pre;color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span>getUser</span></code></pre></strong></td><td style="text-align:left">Checks the user&#x27;s email and password during login.</td></tr></tbody></table>
<h2 id="5-conclusion"><a href="#5-conclusion">5. Conclusion</a></h2>
<p>By moving to this <strong>JWT/RS256</strong> architecture, we solved complex library bugs and achieved a fast, reliable, and modern security system. This foundation is ready to scale with our application!</p></main><aside class="w-56 border-l p-4 h-screen overflow-y-auto sticky top-0"><h2 class="font-semibold mb-3">Minimap</h2><ul class="space-y-1 text-sm"></ul></aside></div><!--$--><!--/$--><script src="/_next/static/chunks/2e4df37f022f10db.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[35972,[\"/_next/static/chunks/10f45d08b09cdbe8.js\"],\"ThemeProvider\"]\n3:I[39447,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"default\"]\n4:I[893,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"default\"]\n5:I[16737,[\"/_next/static/chunks/10f45d08b09cdbe8.js\",\"/_next/static/chunks/b6d55b6773924599.js\"],\"default\"]\nc:I[88496,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"default\"]\n:HL[\"/_next/static/chunks/516aabbd5e7f833d.css\",\"style\"]\n6:Tcaa,"])</script><script>self.__next_f.push([1,"\nWelcome to my first technical deep dive! \n\nIn this post, we explore how we built a super-secure and fast login system. We are using a **Hybrid Security Architecture** that combines **OAuth 2.0** rules with **JSON Web Tokens (JWTs)** signed by **RS256**.\n\n## 1. Architecture Overview: Speed Meets Security\n\nOur goal is simple: make the system fast by making the access key self-checking.\n\n| Component | Technology | Main Job | Key Feature |\n| :--- | :--- | :--- | :--- |\n| **Access Token** | **JWT (RS256)** | The key to accessing our APIs. | **Stateless** (No DB check needed for verification). |\n| **Refresh Token** | Opaque String | The key to get a new Access Token. | **Revocable** (Can be canceled instantly in the DB). |\n| **Server Core** | `express-oauth-server` | Manages all the login and permission rules. | Follows industry standards. |\n| **Database** | PostgreSQL/Prisma | Stores users and the long-term Refresh Tokens. | Data integrity. |\n\n## 2. Token Strategy: Why Two Keys?\n\nWe use two types of tokens because each has a different security role.\n\n### A. Access Token (The Fast Key)\n\n1.  **Format:** JSON Web Token (JWT).\n2.  **Validation:** Signed using a **Private Key** (RS256). The server checks its validity using a **Public Key**.\n3.  **Benefit:** This is extremely fast because the server doesn't need to check the database every time an API is called.\n4.  **Lifespan:** Short (e.g., 1 hour).\n\n### B. Refresh Token (The Safe Key)\n\n1.  **Format:** A random, meaningless string (Opaque Token).\n2.  **Safety:** It **must be saved in the database**. This is the only way we can track long-term sessions.\n3.  **Benefit:** If a user's account is compromised, we can delete the Refresh Token from the database, instantly blocking their ability to get new Access Tokens.\n4.  **Lifespan:** Long (e.g., 1 week).\n\n## 3. Supported Login Flows\n\n### 3.1. Password Grant (The Main Sign-in Flow)\n\n* **Endpoint:** `POST /v1/signin`\n* **How it Works:** This is a custom solution we built to fix a library bug.\n    * Client ID/Secret sent in the **Basic Auth Header**.\n    * Username/Password sent in the **JSON Body**.\n    * The server manually processes the request to ensure tokens are issued correctly.\n\n### 3.2. Authorization Code Grant\n\n* **Endpoint:** `GET /v1/oauth/authorize`\n* **Use Case:** The standard, safest way for third-party apps (like a web service) to get limited access to your user's data.\n\n## 4. Key Code Logic (`oauth.model.ts`)\n\nOur custom security logic lives in the model file. Here’s what the key functions do:\n\n| Model Function | What it Does |\n| :--- | :--- |\n| **`generateAccessToken`** | **Creates the JWT** and signs it using our Private Key. |\n| **`getAccessToken`** | **Verifies the JWT signature** using the Public Key. (It doesn't touch the database). |\n| **`saveToken`** | **Only saves the Refresh Token** to the DB. (It ignores the Access Token). |\n| **`revokeToken`** | Deletes the Refresh Token from the database. |\n| **`getUser`** | Checks the user's email and password during login. |\n\n## 5. Conclusion\n\nBy moving to this **JWT/RS256** architecture, we solved complex library bugs and achieved a fast, reliable, and modern security system. This foundation is ready to scale with our application!"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"peCCg1EsvjH8LOG9VA3pF\",\"c\":[\"\",\"blog\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"blog\",{\"children\":[\"__PAGE__\",{}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/chunks/516aabbd5e7f833d.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/10f45d08b09cdbe8.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"children\":[\"$\",\"$L2\",null,{\"attribute\":\"data-theme\",\"defaultTheme\":\"light\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]}]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[[\"$\",\"div\",null,{\"className\":\"flex\",\"children\":[[\"$\",\"$L5\",null,{\"posts\":[{\"slug\":\"mastering-oauth2-jwt\",\"title\":\"Building a Modern Authentication System: OAuth 2.0 \u0026 JWT (RS256)\",\"date\":\"2025-12-09\",\"excerpt\":\"A simple guide to our Hybrid Security Architecture, using stateless JWT Access Tokens and revocable Refresh Tokens for better security and speed.\",\"cover\":\"\",\"tags\":[\"OAuth2\",\"Security\",\"JWT\",\"Backend\",\"Architecture\"],\"content\":\"$6\"}]}],\"$L7\",\"$L8\"]}],[\"$L9\"],\"$La\"]}],{},null,false,false]},null,false,false]},null,false,false],\"$Lb\",false]],\"m\":\"$undefined\",\"G\":[\"$c\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"1b:I[79268,[\"/_next/static/chunks/10f45d08b09cdbe8.js\",\"/_next/static/chunks/b6d55b6773924599.js\"],\"default\"]\n1c:I[20191,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"OutletBoundary\"]\n1d:\"$Sreact.suspense\"\n1f:I[20191,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"ViewportBoundary\"]\n21:I[20191,[\"/_next/static/chunks/129931008aaa511c.js\",\"/_next/static/chunks/4150d164f44f149b.js\"],\"MetadataBoundary\"]\n"])</script><script>self.__next_f.push([1,"7:[\"$\",\"main\",null,{\"className\":\"flex-1 p-8 prose max-w-3xl\",\"children\":[[\"$\",\"h1\",null,{\"children\":\"Building a Modern Authentication System: OAuth 2.0 \u0026 JWT (RS256)\"}],[[\"$\",\"p\",\"p-0\",{\"children\":\"Welcome to my first technical deep dive!\"}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":[\"In this post, we explore how we built a super-secure and fast login system. We are using a \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"Hybrid Security Architecture\"}],\" that combines \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"OAuth 2.0\"}],\" rules with \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"JSON Web Tokens (JWTs)\"}],\" signed by \",[\"$\",\"strong\",\"strong-3\",{\"children\":\"RS256\"}],\".\"]}],\"\\n\",[\"$\",\"h2\",\"h2-0\",{\"id\":\"1-architecture-overview-speed-meets-security\",\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"#1-architecture-overview-speed-meets-security\",\"children\":\"1. Architecture Overview: Speed Meets Security\"}]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"Our goal is simple: make the system fast by making the access key self-checking.\"}],\"\\n\",[\"$\",\"table\",\"table-0\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Component\"}],[\"$\",\"th\",\"th-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Technology\"}],[\"$\",\"th\",\"th-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Main Job\"}],[\"$\",\"th\",\"th-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Key Feature\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"Access Token\"}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"JWT (RS256)\"}]}],[\"$\",\"td\",\"td-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"The key to accessing our APIs.\"}],[\"$\",\"td\",\"td-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Stateless\"}],\" (No DB check needed for verification).\"]}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"Refresh Token\"}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Opaque String\"}],[\"$\",\"td\",\"td-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"The key to get a new Access Token.\"}],[\"$\",\"td\",\"td-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Revocable\"}],\" (Can be canceled instantly in the DB).\"]}]]}],[\"$\",\"tr\",\"tr-2\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"Server Core\"}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"pre\",\"code-0\",{\"style\":{\"color\":\"black\",\"background\":\"#f5f2f0\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"black\",\"background\":\"none\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segment-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"express-oauth-server\"]}]]]}]}]}],[\"$\",\"td\",\"td-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Manages all the login and permission rules.\"}],[\"$\",\"td\",\"td-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Follows industry standards.\"}]]}],[\"$\",\"tr\",\"tr-3\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":\"Database\"}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"PostgreSQL/Prisma\"}],[\"$\",\"td\",\"td-2\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Stores users and the long-term Refresh Tokens.\"}],[\"$\",\"td\",\"td-3\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Data integrity.\"}]]}]]}]]}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"id\":\"2-token-strategy-why-two-keys\",\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"#2-token-strategy-why-two-keys\",\"children\":\"2. Token Strategy: Why Two Keys?\"}]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":\"We use two types of tokens because each has a different security role.\"}],\"\\n\",\"$Ld\",\"\\n\",\"$Le\",\"\\n\",\"$Lf\",\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\"]]}]\n"])</script><script>self.__next_f.push([1,"8:[\"$\",\"$L1b\",null,{}]\n9:[\"$\",\"script\",\"script-0\",{\"src\":\"/_next/static/chunks/b6d55b6773924599.js\",\"async\":true,\"nonce\":\"$undefined\"}]\na:[\"$\",\"$L1c\",null,{\"children\":[\"$\",\"$1d\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@1e\"}]}]\nb:[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L1f\",null,{\"children\":\"$@20\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$L21\",null,{\"children\":[\"$\",\"$1d\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@22\"}]}]}],null]}]\n"])</script><script>self.__next_f.push([1,"d:[\"$\",\"h3\",\"h3-0\",{\"id\":\"a-access-token-the-fast-key\",\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"#a-access-token-the-fast-key\",\"children\":\"A. Access Token (The Fast Key)\"}]}]\ne:[\"$\",\"ol\",\"ol-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Format:\"}],\" JSON Web Token (JWT).\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Validation:\"}],\" Signed using a \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"Private Key\"}],\" (RS256). The server checks its validity using a \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"Public Key\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Benefit:\"}],\" This is extremely fast because the server doesn't need to check the database every time an API is called.\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Lifespan:\"}],\" Short (e.g., 1 hour).\"]}],\"\\n\"]}]\nf:[\"$\",\"h3\",\"h3-1\",{\"id\":\"b-refresh-token-the-safe-key\",\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"#b-refresh-token-the-safe-key\",\"children\":\"B. Refresh Token (The Safe Key)\"}]}]\n10:[\"$\",\"ol\",\"ol-1\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Format:\"}],\" A random, meaningless string (Opaque Token).\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Safety:\"}],\" It \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"must be saved in the database\"}],\". This is the only way we can track long-term sessions.\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Benefit:\"}],\" If a user's account is compromised, we can delete the Refresh Token from the database, instantly blocking their ability to get new Access Tokens.\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Lifespan:\"}],\" Long (e.g., 1 week).\"]}],\"\\n\"]}]\n11:[\"$\",\"h2\",\"h2-2\",{\"id\":\"3-supported-login-flows\",\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"#3-supported-login-flows\",\"children\":\"3. Supported Login Flows\"}]}]\n12:[\"$\",\"h3\",\"h3-2\",{\"id\":\"31-password-grant-the-main-sign-in-flow\",\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"#31-password-grant-the-main-sign-in-flow\",\"children\":\"3.1. Password Grant (The Main Sign-in Flow)\"}]}]\n"])</script><script>self.__next_f.push([1,"13:[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Endpoint:\"}],\" \",[\"$\",\"pre\",\"code-0\",{\"style\":{\"color\":\"black\",\"background\":\"#f5f2f0\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"black\",\"background\":\"none\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segment-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"POST /v1/signin\"]}]]]}]}]]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"How it Works:\"}],\" This is a custom solution we built to fix a library bug.\",\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"Client ID/Secret sent in the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"Basic Auth Header\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"Username/Password sent in the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"JSON Body\"}],\".\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":\"The server manually processes the request to ensure tokens are issued correctly.\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"14:[\"$\",\"h3\",\"h3-3\",{\"id\":\"32-authorization-code-grant\",\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"#32-authorization-code-grant\",\"children\":\"3.2. Authorization Code Grant\"}]}]\n"])</script><script>self.__next_f.push([1,"15:[\"$\",\"ul\",\"ul-1\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Endpoint:\"}],\" \",[\"$\",\"pre\",\"code-0\",{\"style\":{\"color\":\"black\",\"background\":\"#f5f2f0\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"black\",\"background\":\"none\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segment-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"GET /v1/oauth/authorize\"]}]]]}]}]]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Use Case:\"}],\" The standard, safest way for third-party apps (like a web service) to get limited access to your user's data.\"]}],\"\\n\"]}]\n"])</script><script>self.__next_f.push([1,"16:[\"$\",\"h2\",\"h2-3\",{\"id\":\"4-key-code-logic-oauthmodelts\",\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"#4-key-code-logic-oauthmodelts\",\"children\":[\"4. Key Code Logic (\",[\"$\",\"pre\",\"code-0\",{\"style\":{\"color\":\"black\",\"background\":\"#f5f2f0\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"black\",\"background\":\"none\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segment-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"oauth.model.ts\"]}]]]}]}],\")\"]}]}]\n17:[\"$\",\"p\",\"p-4\",{\"children\":\"Our custom security logic lives in the model file. Here’s what the key functions do:\"}]\n"])</script><script>self.__next_f.push([1,"18:[\"$\",\"table\",\"table-1\",{\"children\":[[\"$\",\"thead\",\"thead-0\",{\"children\":[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"th\",\"th-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Model Function\"}],[\"$\",\"th\",\"th-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"What it Does\"}]]}]}],[\"$\",\"tbody\",\"tbody-0\",{\"children\":[[\"$\",\"tr\",\"tr-0\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"pre\",\"code-0\",{\"style\":{\"color\":\"black\",\"background\":\"#f5f2f0\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"black\",\"background\":\"none\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segment-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"generateAccessToken\"]}]]]}]}]}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Creates the JWT\"}],\" and signs it using our Private Key.\"]}]]}],[\"$\",\"tr\",\"tr-1\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"pre\",\"code-0\",{\"style\":{\"color\":\"black\",\"background\":\"#f5f2f0\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"black\",\"background\":\"none\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segment-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"getAccessToken\"]}]]]}]}]}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Verifies the JWT signature\"}],\" using the Public Key. (It doesn't touch the database).\"]}]]}],[\"$\",\"tr\",\"tr-2\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"pre\",\"code-0\",{\"style\":{\"color\":\"black\",\"background\":\"#f5f2f0\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"black\",\"background\":\"none\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segment-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"saveToken\"]}]]]}]}]}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"Only saves the Refresh Token\"}],\" to the DB. (It ignores the Access Token).\"]}]]}],[\"$\",\"tr\",\"tr-3\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"pre\",\"code-0\",{\"style\":{\"color\":\"black\",\"background\":\"#f5f2f0\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":\"$L23\"}]}]}],\"$L24\"]}],\"$L25\"]}]]}]\n"])</script><script>self.__next_f.push([1,"19:[\"$\",\"h2\",\"h2-4\",{\"id\":\"5-conclusion\",\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"#5-conclusion\",\"children\":\"5. Conclusion\"}]}]\n1a:[\"$\",\"p\",\"p-5\",{\"children\":[\"By moving to this \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"JWT/RS256\"}],\" architecture, we solved complex library bugs and achieved a fast, reliable, and modern security system. This foundation is ready to scale with our application!\"]}]\n"])</script><script>self.__next_f.push([1,"23:[\"$\",\"code\",null,{\"className\":\"language-text\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"black\",\"background\":\"none\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segment-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"revokeToken\"]}]]]}]\n24:[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Deletes the Refresh Token from the database.\"}]\n25:[\"$\",\"tr\",\"tr-4\",{\"children\":[[\"$\",\"td\",\"td-0\",{\"style\":{\"textAlign\":\"left\"},\"children\":[\"$\",\"strong\",\"strong-0\",{\"children\":[\"$\",\"pre\",\"code-0\",{\"style\":{\"color\":\"black\",\"background\":\"#f5f2f0\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"whiteSpace\":\"pre\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\",\"padding\":\"1em\",\"margin\":\".5em 0\",\"overflow\":\"auto\"},\"children\":[\"$\",\"code\",null,{\"className\":\"language-text\",\"style\":{\"whiteSpace\":\"pre\",\"color\":\"black\",\"background\":\"none\",\"textShadow\":\"0 1px white\",\"fontFamily\":\"Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace\",\"fontSize\":\"1em\",\"textAlign\":\"left\",\"wordSpacing\":\"normal\",\"wordBreak\":\"normal\",\"wordWrap\":\"normal\",\"lineHeight\":\"1.5\",\"MozTabSize\":\"4\",\"OTabSize\":\"4\",\"tabSize\":\"4\",\"WebkitHyphens\":\"none\",\"MozHyphens\":\"none\",\"msHyphens\":\"none\",\"hyphens\":\"none\"},\"children\":[false,[[\"$\",\"span\",\"code-segment-0\",{\"className\":\"$undefined\",\"style\":{},\"children\":[\"getUser\"]}]]]}]}]}]}],[\"$\",\"td\",\"td-1\",{\"style\":{\"textAlign\":\"left\"},\"children\":\"Checks the user's email and password during login.\"}]]}]\n"])</script><script>self.__next_f.push([1,"20:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"22:[[\"$\",\"title\",\"0\",{\"children\":\"Hg Q. - Portfolio \u0026 Profiles\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"A Full-Stack Software Engineer and Solutions Architect\"}]]\n1e:null\n"])</script></body></html>